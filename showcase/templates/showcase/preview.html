<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Component Preview</title>
    {% load static %}

    <!-- Base styles for preview iframe -->
    <style>
      body {
        margin: 0;
        padding: 1rem;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        line-height: 1.6;
        color: #333;
        background: #fff;
      }

      /* Reset some basic elements to prevent interference */
      * {
        box-sizing: border-box;
      }

      /* Responsive helpers */
      img {
        max-width: 100%;
        height: auto;
      }

      /* Error styling */
      .preview-error {
        padding: 1rem;
        background: #fee2e2;
        border: 1px solid #fecaca;
        border-radius: 0.375rem;
        color: #dc2626;
      }
    </style>

    {% comment %}
      > Override this template to include your project's CSS files:
      {% extends "showcase/preview.html" %}
      {% block styles %}
        {{ block.super }}
        <link rel="stylesheet" href="{% static 'css/your-styles.css' %}" />
      {% endblock %}
    {% endcomment %}
    {% block styles %}
    {% endblock %}
  </head>
  <body>
    {% block content %}
      <div id="component-container">
        {% if error %}
          <div class="preview-error"><strong>Error:</strong> {{ error }}</div>
        {% else %}
          {{ component_html|safe }}
        {% endif %}
      </div>
    {% endblock content %}

    {% block scripts %}
      <script>
        // Auto-resize iframe to content height
        function updateParentHeight() {
          const height = Math.max(
            document.body.scrollHeight,
            document.body.offsetHeight,
            document.documentElement.clientHeight,
            document.documentElement.scrollHeight,
            document.documentElement.offsetHeight,
          );

          // Send height to parent window
          if (window.parent && window.parent !== window) {
            window.parent.postMessage(
              {
                type: "resize",
                height: height,
              },
              "*",
            );
          }
        }

        // Update height when content changes
        document.addEventListener("DOMContentLoaded", updateParentHeight);
        window.addEventListener("resize", updateParentHeight);

        // Use MutationObserver to detect content changes
        const observer = new MutationObserver(updateParentHeight);
        observer.observe(document.body, {
          childList: true,
          subtree: true,
          attributes: true,
        });
      </script>
    {% endblock scripts %}
  </body>
</html>
